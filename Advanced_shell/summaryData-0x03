#!/bin/bash

# Directory where the PokÃ©mon JSON files are stored
DIRECTORY="Advanced_shell"

# Output CSV file
OUTPUT_FILE="pokemon_report.csv"

# Initialize CSV file with headers
echo "Name,Height,Weight" > "$OUTPUT_FILE"

# Variables to calculate the sum of height and weight
total_height=0
total_weight=0
count=0

# Loop through each JSON file in the directory
for file in "$DIRECTORY"/*.json; do
  # Extract name, height, and weight from the JSON file using jq
  name=$(jq -r '.name' "$file")
  height=$(jq -r '.height' "$file")
  weight=$(jq -r '.weight' "$file")

  # Convert height and weight from decimeters and hectograms to meters and kilograms
  height_in_meters=$(echo "$height / 10" | bc -l)
  weight_in_kg=$(echo "$weight / 10" | bc -l)

  # Append the extracted data to the CSV file
  echo "$name,$height_in_meters,$weight_in_kg" >> "$OUTPUT_FILE"

  # Add the height and weight to the totals
  total_height=$(echo "$total_height + $height_in_meters" | bc -l)
  total_weight=$(echo "$total_weight + $weight_in_kg" | bc -l)
  count=$((count + 1))
done

# Calculate averages using awk
average_height=$(echo "scale=2; $total_height / $count" | bc)
average_weight=$(echo "scale=2; $total_weight / $count" | bc)

# Output the average height and weight
echo "Average Height: $average_height meters"
echo "Average Weight: $average_weight kg"
